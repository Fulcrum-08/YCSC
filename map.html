<!DOCTYPE html>
<html>
<head>
    <title>My Shape Map with Layers</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
        #map { height: 100vh; width: 100%; }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Initialize map
        var map = L.map('map').setView([42.33, -72.68], 13);

        // Object to store all layers
        var geoLayers = {};

        // Function to load a GeoJSON file and add it as a layer
        function addGeoJSONLayer(name, url, color) {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    var layer = L.geoJSON(data, {
                        style: {
                            color: color,
                            weight: 2,
                            fillOpacity: 0.3
                        },
                        onEachFeature: function(feature, layer) {
                            if (feature.properties) {
                                const popup = Object.entries(feature.properties)
                                    .map(([k,v]) => `${k}: ${v}`)
                                    .join("<br/>");
                                layer.bindPopup(popup);
                            }
                        }
                    });
                    geoLayers[name] = layer;  // store the layer
                    layer.addTo(map);          // optionally add it by default
                    map.fitBounds(layer.getBounds());
                    updateLayerControl();
                })
                .catch(err => console.error("Error loading GeoJSON:", err));
        }

        // Add your GeoJSON files here
        addGeoJSONLayer("Ward", "wards.geojson", "blue");
        addGeoJSONLayer("Buildings", "buildings.geojson", "red");
        addGeoJSONLayer("River", "CTriver.geojson", "red"); // example

        // Layer control
        var layerControl = L.control.layers(null, null, { collapsed: false }).addTo(map);

        // Update layer control once layers are loaded
        function updateLayerControl() {
            layerControl.remove(); // remove old control
            layerControl = L.control.layers(null, geoLayers, { collapsed: false }).addTo(map);
        }
    </script>
</body>
</html>
