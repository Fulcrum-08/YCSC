<!DOCTYPE html>
<html>
<head>
    <title>My Shape Map with Layers</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        header {
            padding: 20px;
            background-color: #f0f0f0;
            text-align: center;
        }

        #map {
            flex: 1; /* takes up remaining space */
            width: 100%;
        }

        .description {
            max-width: 800px;
            margin: 10px auto;
            text-align: center;
            font-size: 16px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <header>
        <h1>City Map with Layers</h1>
    </header>
    <div class="description">
        <p>
            This interactive map shows different layers of the city, including wards, buildings, rivers, and roads.
            Click on any feature to see more information about it. You can toggle layers using the layer control box
            on the top-right corner of the map.
        </p>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Initialize map
        var map = L.map('map').setView([42.33, -72.68], 13);

        // Object to store all layers
        var geoLayers = {};

        // Function to load a GeoJSON file and add it as a layer
        function addGeoJSONLayer(name, url, color) {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    var layer = L.geoJSON(data, {
                        style: {
                            color: color,
                            weight: 2,
                            fillOpacity: 0.3
                        },
                        onEachFeature: function(feature, layer) {
                            if (feature.properties) {
                                const popup = Object.entries(feature.properties)
                                    .map(([k,v]) => `${k}: ${v}`)
                                    .join("<br/>");
                                layer.bindPopup(popup);
                            }
                        }
                    });
                    geoLayers[name] = layer;  // store the layer
                    layer.addTo(map);          // optionally add it by default
                    map.fitBounds(layer.getBounds());
                    updateLayerControl();
                })
                .catch(err => console.error("Error loading GeoJSON:", err));
        }

        // Add your GeoJSON files here
        addGeoJSONLayer("Ward", "wards.geojson", "blue");
        addGeoJSONLayer("Buildings", "buildings.geojson", "red");
        addGeoJSONLayer("River", "CTriver.geojson", "red");
        addGeoJSONLayer("Roads", "roads.geojson", "red");

        // Layer control
        var layerControl = L.control.layers(null, null, { collapsed: false }).addTo(map);

        // Update layer control once layers are loaded
        function updateLayerControl() {
            layerControl.remove(); // remove old control
            layerControl = L.control.layers(null, geoLayers, { collapsed: false }).addTo(map);
        }
    </script>
</body>
</html>
